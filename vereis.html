<!DOCTYPE html>
<html>
    <head>
        <title>root://</title>
		<meta charset="UTF-8">
        <link rel = "stylesheet" type = "text/css" href = "http://meyerweb.com/eric/tools/css/reset/reset.css">
		<script src = "https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
		<style>
		    * {
    box-sizing: border-box;
}
body {
    position: absolute;
    height: 100%;
    width: 100%;
    background: #78c9a1;
    padding-left: 2ex;
    top: -2ex;
}
p {
    display: inline;
}
#terminal {
    overflow-y: auto;
    overflow-x: hidden;
    color: #c978a0;
    top: -2ex;
}
#prompt, #input, .output, .prompt_Old, .input_Old, #caret, .ppost, #post{
    display: inline;
    font-family: "Sazanami Gothic", monospace;
    font-size: 8pt;
    outline: none;
    text-decoration: none;
    width: 0;
}
#input br {
    display: none;
}
.output {
    color: #777abc;
}
#post {
    position: relative;
    margin-left: -5px;
}

#caret {
    font-size: 7pt;
	animation: blink 0.8s steps(2, start) infinite;
}
@keyframes blink {
    0% {
		visibility: block;
	}
	50% {
        visibility: hidden;
    }
}
#input {
    color: #777abc;
}

.rssFeedList{
    width:450px; 
    list-style:none outside none;
    background-color: transparent; 
    border:0px solid #D3CAD7; 
    margin-left: 3ex;
}
.rssFeedList li {
    padding-bottom: 1ex;
}
.rssFeedList li:last-child {
    padding-bottom: 0ex !important;
}
.itemTitle a:hover{ 
    text-decoration: none;
}

.itemContent {
    padding-left: 4ex;
	color: #888;
}

.rssFeedList a , .itemDate, p ,pre, li{
    font-family: "Sazanami Gothic", monospace;
    font-size: 8pt;
    text-decoration: none
}

.itemTitle a{
    color:#777abc !important; 
    text-decoration: none 
}


#loading {
    padding-top: 12px;
}
#loading ul, #loading ul li {
    display: inline;
    visibility: hidden;
}
#loading ul li:nth-child(1){
    animation: dot 2s infinite;
}
#loading ul li:nth-child(2){
    animation: dot2 2s infinite;
}
#loading ul li:nth-child(3){
    animation: dot3 2s infinite;
}
@keyframes dot {
    0% {visibility: hidden;}
    20% {visibility: hidden;}
    40% {visibility: visible;}
    60% {visibility: visible;}
    80% {visibility: visible;}
    100% {visibility: visible;}
}
@keyframes dot2 {
    0% {visibility: hidden;}
    20% {visibility: hidden;}
    40% {visibility: hidden;}
    60% {visibility: visible;}
    80% {visibility: visible;}
    100% {visibility: visible;}
}
@keyframes dot3 {
    0% {visibility: hidden;}
    20% {visibility: hidden;}
    40% {visibility: hidden;}
    60% {visibility: hidden;}
    80% {visibility: visible;}
    100% {visibility: visible;}
}
		</style>
    </head>
    <body>
		<div id = "terminal">
		</div>
    </body>
	
	
<!-- C O M M A N D S    F O R    T H E    T E R M I N A L -->
    <script>
        function drawLoad()
{
	$("#terminal").append(loading);
}

function drawSeperator(i)
{
	seperatorLength = i;
	seperator = Array(seperatorLength+1).join("-");
	$("#terminal").append("<br id='nl'> <pre class = 'output'>" + seperator + "</pre>");
}

function printHelp(messageArray, mode)
{
	if (mode == "argList")
	{
		messageArray.sort();
		var output = ""
		for (i = 0 ; i < messageArray.length; i++)
		{	
			 output += " [--" + messageArray[i] + "]"
		}
	}
	
	else if (mode == "special")
	{
		
	}
	
	else
	{
		var output = "";
		for (i = 0; i < messageArray.length; i++)
		{
			output += messageArray[i] + "<br id = nl>" ;
		}
	}
	return output;
}
    </script>
	<script>
	    //Namespace management idea from http://enterprisejquery.com/2010/10/how-good-c-habits-can-encourage-bad-javascript-habits-part-1/
	(function( cursorManager ) {

			//From: http://www.w3.org/TR/html-markup/syntax.html#syntax-elements
			var voidNodeTags = ['AREA', 'BASE', 'BR', 'COL', 'EMBED', 'HR', 'IMG', 'INPUT', 'KEYGEN', 'LINK', 'MENUITEM', 'META', 'PARAM', 'SOURCE', 'TRACK', 'WBR', 'BASEFONT', 'BGSOUND', 'FRAME', 'ISINDEX'];

			//From: http://stackoverflow.com/questions/237104/array-containsobj-in-javascript
			Array.prototype.contains = function(obj) {
				var i = this.length;
				while (i--) {
					if (this[i] === obj) {
						return true;
					}
				}
				return false;
			}

			//Basic idea from: http://stackoverflow.com/questions/19790442/test-if-an-element-can-contain-text
			function canContainText(node) {
				if(node.nodeType == 1) { //is an element node
					return !voidNodeTags.contains(node.nodeName);
				} else { //is not an element node
					return false;
				}
			};

			function getLastChildElement(el){
				var lc = el.lastChild;
				while(lc && lc.nodeType != 1) {
					if(lc.previousSibling)
						lc = lc.previousSibling;
					else
						break;
				}
				return lc;
			}

			//Based on Nico Burns's answer
			cursorManager.setEndOfContenteditable = function(contentEditableElement)
			{

				while(getLastChildElement(contentEditableElement) &&
					  canContainText(getLastChildElement(contentEditableElement))) {
					contentEditableElement = getLastChildElement(contentEditableElement);
				}

				var range,selection;
				if(document.createRange)//Firefox, Chrome, Opera, Safari, IE 9+
				{    
					range = document.createRange();//Create a range (a range is a like the selection but invisible)
					range.selectNodeContents(contentEditableElement);//Select the entire contents of the element with the range
					range.collapse(false);//collapse the range to the end point. false means collapse to end rather than the start
					selection = window.getSelection();//get the selection object (allows you to change selection)
					selection.removeAllRanges();//remove any selections already made
					selection.addRange(range);//make the range you have just created the visible selection
				}
				else if(document.selection)//IE 8 and lower
				{ 
					range = document.body.createTextRange();//Create a range (a range is a like the selection but invisible)
					range.moveToElementText(contentEditableElement);//Select the entire contents of the element with the range
					range.collapse(false);//collapse the range to the end point. false means collapse to end rather than the start
					range.select();//Select the range (make it the visible selection
				}
			}

		}( window.cursorManager = window.cursorManager || {}));
	</script>
	<script>
	    $.fn.getRSS = function (opt) 
{
	var def = $.extend({MaxCount: 5,
						ShowDesc: true,
						ShowPubDate: true,
						DescCharacterLimit: 15,
						TitleLinkTarget: "_blank",
						DateFormat: "",
						DateFormatLang:"en" }, opt);
	
	var id = $(this).attr("id"), i, s = "", dt;
	$("#" + id).empty();
	
	if (def.FeedUrl == undefined) return;       
	//$("#" + id).append(loading);
	drawLoad();

	var yahooString = 'SELECT channel.item FROM feednormalizer WHERE output="rss_2.0" AND url ="' + def.FeedUrl + '" LIMIT ' + def.MaxCount;

	$.ajax({
		url: "https://query.yahooapis.com/v1/public/yql?q=" + encodeURIComponent(yahooString) + "&format=json&diagnostics=false&callback=?",
		dataType: "json",
		success: function (data) 
		{
			$("#loading").remove();
			$("#" + id).empty();
			if (!(data.query.results.rss instanceof Array)) { data.query.results.rss = [data.query.results.rss]; }

			$.each(data.query.results.rss, function (e, itm) 
			{
				s += '<li><div class="itemTitle"><a href="' + itm.channel.item.link + '" target="' + def.TitleLinkTarget + '" >' + itm.channel.item.title + '</a></div>';
				
				if (def.ShowPubDate)
				{
					dt = new Date(itm.channel.item.pubDate);
					s += '<pre class="itemDate">';
					if ($.trim(def.DateFormat).length > 0) 
					{
						try { moment.lang(def.DateFormatLang); s += moment(dt).format(def.DateFormat); }
						catch (e){s += dt.toLocaleDateString();}                            
					}
					else { s += dt.toLocaleDateString(); }
					
					s += '</div>';
				}
				
				if (def.ShowDesc) 
				{
					s += '<div class="itemContent">';
					if (def.DescCharacterLimit > 0 && itm.channel.item.description.length > def.DescCharacterLimit) 
					{
						s += itm.channel.item.description.substring(0, def.DescCharacterLimit) + '...';
					}
					else { s += itm.channel.item.description; }
					
					s += '</div>';
				}
			});
			
			$("#" + id).append('<ul class="rssFeed">' + s + '</ul>');

		}
	});
};
	</script>
	
	<script>
	    //------------------------------------------------------------------------------------------------------------------------------------------------------------------/

function catchEnter() //Intercepts enter presses when on input
{
	$("#input").keydown(function(e)
	{   
		$("#input br").remove();
		if (e.which == 13)
		{
			parseInput($("#input").text());
			return false;
		}
	});
}

//------------------------------------------------------------------------------------------------------------------------------------------------------------------/

function catchClick() // Intercepts clicks on body
{
	$("body").click(function()
	{
	   focusEnd();
	});
}

//------------------------------------------------------------------------------------------------------------------------------------------------------------------/

function catchLR()
{
	$("#input").keyup(function(e)
	{
		if (e.which == 37 && $("#input").text().length > 0)
		{
			var end = $("#input").length;
			var currentText = $("#input").text();
			$("#input").remove();
			$("#prompt").append("<pre id = 'input' contentEditable = 'true'>" + currentText.substring(0, currentText.length-1) + "</pre>");
			focusEnd();
			$("#post").prepend("<pre class = 'ppost'>" + currentText.substring(currentText.length-1, currentText.length) + "</pre>");
			
			setTimeout(10,resetInput());
			
			return false;
		}
		else if (e.which == 39)
		{
			var currentText = $("#input").text();
			var newText = currentText + $(".ppost:first-child").text();
			$("#input").remove();
			$("#prompt").append("<pre id = 'input' contentEditable = 'true'>" + newText + "</pre>");
			focusEnd();
			$(".ppost:first-child").remove();

			setTimeout(10,resetInput());
			
			return false;
		}
		else if (e.which == 46)
		{
			var childrenLen = $("#post").children().length;
			if (childrenLen < 1)
			{
				var end = $("#input").length;
				var currentText = $("#input").text();
				$("#input").remove();
				$("#prompt").append("<pre id = 'input' contentEditable = 'true'>" + currentText.substring(0, currentText.length-1) + "</pre>");
				focusEnd();
				setTimeout(10,resetInput());
			}
			else
			{
				$(".ppost:first-child").remove();
			}
			return false;
		}
	});
}

//------------------------------------------------------------------------------------------------------------------------------------------------------------------/

function catchUD()
{
	$("#input").keyup(function(e)
	{
		if (e.which == 38)
		{
			if (historyIndex >= 2)
			{
				historyIndex--;
				$("#input").remove();
				$("#prompt").append("<pre id = 'input' contentEditable = 'true'>" + historyList[historyIndex] + "</pre>");
				$(".ppost").remove();
				focusEnd();
				setTimeout(10,resetInput());
			}
			else
			{
			}
		}
		else if (e.which == 40)
		{
			if (historyIndex < historyList.length-1)
			{
				historyIndex++;
				$("#input").remove();
				$("#prompt").append("<pre id = 'input' contentEditable = 'true'>" + historyList[historyIndex] + "</pre>");
				$(".ppost").remove();
				focusEnd();
				setTimeout(10,resetInput());
			}
			else if (historyIndex == historyList.length-1)
			{
				$("#input").remove();
				$("#prompt").append("<pre id = 'input' contentEditable = 'true'></pre>");
				$(".ppost").remove();
				focusEnd();
				setTimeout(10,resetInput());
			}
		}
	});
}
	</script>
	<script>
	    function print(output) // Prints something to the console
{
	$("#terminal").append("<br class = 'nl'> <pre class = 'output'>" + output + "</pre>");
}

function parseInput(input) // Gets the input from #input and tries to read it.
{
	var input2 = "";
	var childrenLen = $("#post").children().length;
	$("#post").contents().each(function(i) 	
	{ 
		//alert($(".ppost:nth-child(" + (i+1) + ")").text());	
		//alert($(".ppost:nth-child(" + (childrenLen - i) + ")").text());
		input2 += $(".ppost:nth-child(" + (i+1) + ")").text()
	})
	var doubleDash = "--";
	var combinedInput = input + input2;
	var standardisedString = combinedInput.replace(/\s\s+/g, " ") && combinedInput.replace(doubleDash,"");		// Remove areas of multiple whitespace and also removes dashes
		historyList.push(standardisedString);
		historyList[0] = historyList.length;
		historyIndex = historyList[0];
	var parsedString = standardisedString.trim().split(" ");		// Split the string into several based on whitespace
	validate(parsedString, input);
}

function validate(input, original) // Validates a functions and arguments
{
	var stringLength = input.length - 1; // Empty string beginning and end count too for some reason, lets sanitise
	var flag = false;
	
	//print(stringLength);
	
	for (i = 0; i <= COMMAND_LIST.length; i++) // Is the first segment of the input a valid command?
	{
		if (COMMAND_LIST[i] == input[0])
		{
			flag = true; // If so, cool
		}
	}

	if (flag == true) // Depending on the results of the previous test, either proceed here, or below..
	{
		if (stringLength > 0) // If there is more than one segment to our input, we'll use em as arguments
		{
			var args = []; 

			for (i = 1; i <= stringLength; i++)
			{
				if (input[i] != null) { args[i-1] = input[i]; }  
			}

			evaluate(input[0], args);
		}
		else // Otherwise call evaluate without any arguments
		{
			evaluate(input[0], "empty");
		}
	}
	else
	{
		var error = "The specified command " + input[0] + " was not recognised as a valid command."
		print(error);
		respond("null");
	}
}

function evaluate(input, args) // Executes different code depending on input and arguments 
{
	if (input == "clear")
	{
		clear(args);
	}
	
	
	else if (input == "echo")
	{
		echo(args);
	}
	
	else if (input == "about")
	{
		about(args);
	}

	else if (input == "help") // The loop automatically prints every command with every associated help message
	{
		help(args);
	}
	
	
	else if (input == "google" || input == "youtube") // These section governs sites you can search
	{
		search(input, args);
	}
	
	
	else if (input == "site" || input == "facebook" || input == "wikipedia" || input == "discord" || input == "trello") // This just redirects either to a site shorthand such as facebook
	{
		redir(input, args);
	}
	
	else if (input == "rss")
	{
		rss(input, args);
	}

}

function respond(input) // Prints new prompt and input. 
{
	$("#prompt").attr("class", "prompt_Old");
	$("#prompt").attr("id", null);
	$("#caret").remove();
	$("#post").attr("class", "input_Old");
	$("#post").attr("id", null);
	$(".input_Old").contents().each(function(i) 	
	{ 
		$(".ppost:nth-child(" + (i+1) + ")").attr("class", "input_Old");
		$(".ppost:nth-child(" + (i+1) + ")").attr("id", null);
	})
	$("#input").attr("class", "input_Old");
	$("#input").attr("id", null);
	$(".input_Old").attr("contentEditable", "false");
	if(input == "!br")
	{
		$("#terminal").append(promptString + inputString + inputBlock + postInput);
	}
	else
	{
		$("#terminal").append("<br class = 'nl'>" + promptString + inputString + inputBlock + postInput);
	}
	$("#input").focus();
	resetInput();
}

function focusEnd()
{
	$("#input").focus();
	var editableDiv = document.getElementById("input");
	cursorManager.setEndOfContenteditable(editableDiv);
}

//------------------------------------------------------------------------------------------------------------------------------------------------------------------/

function resetInput()
{
	catchEnter();
	catchClick();
	catchLR();
	catchUD();
}
	</script>

	<script>
	    /*
* Clears terminal screen
* Author : Vereis~
*/

function clear(args)
{
    var helpDesc = ["This function clears the current terminal and repopulates it."];
	
	if (args[0] == "help")
	{
		print(printHelp(helpDesc));
	}
	else
	{
		$("#terminal .nl, p, pre, .input_Old, #rss, .rss_Old, li, ul, #nl").remove(); // Clear the screen
	}
    respond("!br"); // We don't want a newline
}
	</script>
	<script>
	    /*
* Echos argument(s)
* Author : Vereis~
*/

function echo(args)
{
	var helpDesc = ["This isnt accessible anyway"];
	
	if (args == "empty")
    {
        print("''"); // If no argument was given, don't echo anything
    }
    else
    {
        var returnString = ""
        for (i = 0; i != args.length; i++)
            {
                returnString += args[i] + " "; // Otherwise echo all arguments in series  
            }
        print(returnString);
        }
    respond();
}
	</script>
	<script>
	    /*
* Prints about info
* Author : Vereis~
*/


function about(args)
{
	var helpDesc = ["This function prints out some standard about information. This function takes no arguments"];
	
    if (args[0] == "help")
	{
		print(printHelp(helpDesc));
	}
	else
	{
		print("Testing information");
		print("More testing information More testing information More testing information ");
		print(tab + "Hobbies and Interests:");
		print(tab + tab + "- xyz");
		print(tab + tab + "- yza");
	}
    respond();
}
	</script>
	<script>
	    /*
* Loops over all possible commands, displaying help info
* Author : Vereis~
*/

function help(args)
{
	var helpDesc = ["Prints a description of every command"];
	
	if (args[0] == "help")
	{
		print(printHelp(helpDesc));
	}
	else
	{
		print("Below are the list of commands recognised by the system:");
		//print("");
		for (i = 0; i != COMMAND_LIST.length; i++)
		{
			var customTab = Array(((tabLength*5)+1) - COMMAND_LIST[i].length).join(" ");
			print(tab + COMMAND_LIST[i] + customTab  + HELP_LIST[i]);
		}
		print("For more information about these tools, you can try typing command --help");
		print("");
	}

	respond();
}
	</script>
	<script>
	    /*
* Searches either youtube or google
* Author : Vereis~
*/

function search(input, args)
{
	if (input == "google") // This if/else tree generates pre-query urls
	{	
		var http = "https://www.google.com/search?q=";
	}
	else if (input == "youtube")
	{
		var http = "https://www.youtube.com/results?search_query=";
	}

	// --------------------------------------------------------------------- //
	
	if (args == "empty") // This if/else tree generates a search string and or redirects to said site
	{
		window.location = http; // This may as well be an alias of site args for specific sites
	}
	else if (args != "empty")
	{
		var query = "";
		for (i = 0; i != args.length; i++)
		{
			query += args[i] + "+";
		}
		window.location = http + query; // Otherwise perform a search
	}
}
	</script>
	<script>
	    /*
* Redirects to given site
* Author : Vereis~
*/

function redir(input, args)
{
	if(input != "site" && input !="preferences" && input !="discord") { var http = "https://www." + input + ".com"; }
	else if (input == "site") { var http = "https://www." + args[0];
								if (args.length > 1) { http += "." + args[1] }}
	else { var http = "http://www." + input + ".gg";}
	window.location = http;
}
	</script>
	<script>
	    /*
* jterm - rss-get: generates and displays a rss feed
* Author : Vereis~
*/

function rss(input, args)
{
	var helpDesc = ["weather", "nyaa", "daily", "tech", "ted", "reddit", "help", "version"]
	
	var pages = 5;
	var url = '';
	
	if (args == "empty" || args[0] == "help")
	{
		print("Usage: rss" + printHelp(helpDesc, "argList"));
	}
	else if (args[0] == "version") 
	{
		print("jterm rss version 1.0");
	}
	else if (args.length > 0)
	{
		if (args[0] == "weather")
		{
			url = 'http://open.live.bbc.co.uk/weather/feeds/en/2643123/3dayforecast.rss';
		}
		else if (args[0] == "nyaa")
		{
			url = 'http://www.nyaa.se/?page=rss';
		}
		else if (args[0] == "daily")
		{
			url = 'http://feeds.feedburner.com/InterestingThingOfTheDay';
		}
		else if (args[0] == "tech")
		{
			url = 'http://feeds.feedburner.com/techradar/computing-news?format=xml';
		}
		else if (args[0] == "ted")
		{
			url = 'http://feeds.feedburner.com/tedtalks_video';
		}
		else if (args[0] == "reddit")
		{
			url = 'http://www.reddit.com/.rss';
		}
		
		if (args.length > 1) { pages = args[1]; }
		
		$("#rss").attr("class", "rss_Old")
		$("#rss").attr("id", null);
		
		drawSeperator(120);
		print(" ");
			$("#terminal").append("<div id = rss></div>");
			$("#rss").getRSS({
				FeedUrl: url,
				MaxCount : pages,
				ShowDesc : true,
				ShowPubDate:true,
				DescCharacterLimit:100,
				TitleLinkTarget:'_blank',
				});
		drawSeperator(120);
	}

	respond();
}
	</script>
<!-- C O M M A N D S    F O R    T H E    T E R M I N A L -->
	
	
<!-- M U H    F U N C T I O N A L I T Y -->	
	<script>

        // -- CONSTANTS N SUCH -- //

        var username = "Guest";
        var host = "Shiromonogatari";
        var cd = "/moe";
        var promptString = "<p id = 'prompt' >" + username + "@" + host + "[" + cd + "]: </p>";
        var inputString = "<pre id  = 'input' contentEditable = 'true'></pre>";
        var inputBlock = "<pre id = 'caret'>&#9608;</pre>";
        var postInput = "<div id = 'post'></div>"; 

		var seperatorLength = 4;
		var seperator = Array(seperatorLength+1).join("-")		
		
        var tabLength = 4;
        var tab = Array(tabLength+1).join(" ");
		
		var loading = "<div id='loading'><p>loading</p><ul><li>.</li><li>.</li><li>.</li></ul></div>"

		
		// -- ACTUAL RUNNING CODE BELOW -- //


        $(document).ready(function() {	
			print("The font 'Sazayama Gothic' is highly recommended, though attempts have been made to not be overly dependent on this.");
			print("<p><i>Version 3; test release. Please email suggestions to 6c556d22b7@outlook.com~</i></p>");
			
			$("#terminal").append("<br>" + promptString + inputString + inputBlock + postInput);
            $("#input").focus();
			resetInput();
        });
		
		
		// --COMMAND n HELP LIST -- //
		
		
		var COMMAND_LIST = ["echo", "clear", "help", "google", 
							"facebook", "youtube", "site", "about", 
							"wikipedia", "cd", "ls", "pwd", 
							"rss", "discord", "trello",
						   ];
        
        var HELP_LIST = ["The console prints out the arguments to this function", 
						 "Clears and redraws the terminal",
                         "Displays a list of recognised functions", 
						 "Performs a Google Search containing arguments",
                         "Redirects to Facebook, taking no arguments", 
						 "Performs a YouTube search with arguments",
                         "Redirects to argument.com, or argument.argument2 if specified", 
                         "displays generic about information", 
						 "Redirects to wikipedia.com", "Changes current location",
                         "Shows files in current location", 
						 "Prints the current location", 
						 "Gets an RSS feed. Arg 1 = Source, Arg 2 = number of results",
						 "Redirects to Discord IRC", "Life Planning :)"];
						 
		var historyList = [0,];
		
		var historyIndex = 0;
		
    </script>
</html>
