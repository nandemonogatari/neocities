(()=>{var s={171:function(s,t,i){var h=this&&this.t||(Object.create?function(s,t,i,h){void 0===h&&(h=i);var e=Object.getOwnPropertyDescriptor(t,i);e&&!("get"in e?!t.i:e.writable||e.configurable)||(e={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(s,h,e)}:function(s,t,i,h){void 0===h&&(h=i),s[h]=t[i]}),e=this&&this.h||(Object.create?function(s,t){Object.defineProperty(s,"default",{enumerable:!0,value:t})}:function(s,t){s.default=t}),a=this&&this.k||function(s){if(s&&s.i)return s;var t={};if(null!=s)for(var i in s)"default"!==i&&Object.prototype.hasOwnProperty.call(s,i)&&h(t,s,i);return e(t,s),t},r=this&&this.o||function(s){return s&&s.i?s:{default:s}};Object.defineProperty(t,"i",{value:!0});const c=a(i(806)),b=r(i(706)),n=r(i(364));function k(s,t,i){const h=s.createShader(i);if(!h)throw"Unable to create shader of type "+i;if(s.shaderSource(h,t),s.compileShader(h),!s.getShaderParameter(h,s.COMPILE_STATUS))throw"Unable to compile shader "+t+" "+s.getShaderInfoLog(h);return h}function o(){const s=document.getElementById("gb-canvas"),t=(document.body.clientWidth-32)/160,i=(document.body.clientHeight-96)/144,h=Math.floor(Math.max(1,Math.min(5,t,i)));s.width=160*h,s.height=144*h}async function u(){const s=[{title:"ROM: adjustris",data:new Uint8Array(await(await fetch("roms/adjtris.gb")).arrayBuffer())},{title:"ROM: Sheep It Up!",data:new Uint8Array(await(await fetch("roms/sheepitup.gb")).arrayBuffer())},{title:"ROM: gejmboj demo",data:new Uint8Array(await(await fetch("roms/gejmboj.gb")).arrayBuffer())}];o(),Array.from(document.getElementsByClassName("loading")).forEach(s=>s.style.display="none"),Array.from(document.getElementsByClassName("loaded")).forEach(s=>s.style.display="inherit");let t=0;document.getElementById("rom-title").textContent=s[t].title;let i=new b.default(new Uint8Array(s[t].data)),h=new n.default(i),e=new c.default(i),a=new c.u(i);const r=()=>{document.getElementById("rom-title").textContent=s[t].title,i=new b.default(new Uint8Array(s[t].data)),h=new n.default(i),e=new c.default(i),a=new c.u(i)},u=document.getElementById("gb-canvas").getContext("webgl2"),l=u.createTexture();u.activeTexture(u.TEXTURE0),u.bindTexture(u.TEXTURE_2D,l),u.pixelStorei(u.UNPACK_ALIGNMENT,1),u.texImage2D(u.TEXTURE_2D,0,u.R8,160,144,0,u.RED,u.UNSIGNED_BYTE,null),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.NEAREST),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.NEAREST),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE);const f=u.createTexture();u.activeTexture(u.TEXTURE1),u.bindTexture(u.TEXTURE_2D,f),u.texImage2D(u.TEXTURE_2D,0,u.RGB8,4,1,0,u.RGB,u.UNSIGNED_BYTE,new Uint8Array([15,56,15,48,98,48,139,172,15,155,188,15])),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE);const d=u.createTexture();u.activeTexture(u.TEXTURE2),u.bindTexture(u.TEXTURE_2D,d);const w=[];for(let s=0;s<4;s++)for(let t=0;t<4;t++)w.push(0==t||0==s?0:255);u.texImage2D(u.TEXTURE_2D,0,u.R8,4,4,0,u.RED,u.UNSIGNED_BYTE,new Uint8Array(w)),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.REPEAT);const m=k(u,"#version 300 es\n\nprecision mediump float;\nin vec2 frag_texcoord;\nout vec4 frag_color;\nuniform sampler2D tex;\nuniform sampler2D tex_palette;\nuniform sampler2D tex_grid;\n\nvoid main() {\n    const vec2 texsize = vec2(160.0, 144.0);\n\n    float grid = texture(tex_grid, frag_texcoord * texsize).r;\n    float pal0 = texture(tex, frag_texcoord.xy).r;\n    pal0 = mix(1.0, pal0, grid);\n\n    vec3 r_color = texture(tex_palette, vec2(pal0, 0.0)).rgb;\n    frag_color = vec4(r_color, 1.0);\n}\n",u.FRAGMENT_SHADER),p=k(u,"#version 300 es\n\nprecision mediump float;\nin vec2 pos;\nout vec2 frag_texcoord;\n\nvoid main() {\n    vec2 screenpos = 2.0 * pos - vec2(1.0, 1.0);\n    gl_Position = vec4(screenpos.xy, 0.0, 1.0);\n    frag_texcoord.xy = vec2(pos.x, 1.0 - pos.y);\n}\n",u.VERTEX_SHADER),v=function(s,t,i){const h=s.createProgram();if(!h)throw"Unable to create program";if(s.attachShader(h,t),s.attachShader(h,i),s.linkProgram(h),!s.getProgramParameter(h,s.LINK_STATUS))throw"Unable to link program "+s.getProgramInfoLog(h);return h}(u,p,m);u.useProgram(v);const g=u.createBuffer(),y=u.createBuffer();u.bindBuffer(u.ARRAY_BUFFER,g),u.bufferData(u.ARRAY_BUFFER,new Float32Array([0,0,1,0,1,1,0,1]),u.STATIC_DRAW),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,y),u.bufferData(u.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,0,2,3]),u.STATIC_DRAW);const _=u.getAttribLocation(v,"pos"),x=u.getUniformLocation(v,"tex"),R=u.getUniformLocation(v,"tex_palette"),A=u.getUniformLocation(v,"tex_grid");u.enableVertexAttribArray(_),u.vertexAttribPointer(_,2,u.FLOAT,!1,8,0),u.bindFramebuffer(u.FRAMEBUFFER,null),u.viewport(0,0,u.canvas.width,u.canvas.height),u.clearColor(1,1,1,1),u.clear(u.COLOR_BUFFER_BIT);let j=0;const U=()=>{for(;j<17556;){const s=e.l();h.l(s,!0),a.l(s),j+=s}j-=17556,u.bindFramebuffer(u.FRAMEBUFFER,null),u.viewport(0,0,u.canvas.width,u.canvas.height),u.activeTexture(u.TEXTURE1),u.bindTexture(u.TEXTURE_2D,f),u.activeTexture(u.TEXTURE2),u.bindTexture(u.TEXTURE_2D,d),u.activeTexture(u.TEXTURE0),u.bindTexture(u.TEXTURE_2D,l),u.texSubImage2D(u.TEXTURE_2D,0,0,0,160,144,u.RED,u.UNSIGNED_BYTE,new Uint8Array(h.m())),u.useProgram(v),u.bindBuffer(u.ARRAY_BUFFER,g),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,y),u.enableVertexAttribArray(_),u.uniform1i(x,0),u.uniform1i(R,1),u.uniform1i(A,2),u.drawElements(u.TRIANGLES,6,u.UNSIGNED_SHORT,0),window.requestAnimationFrame(U)};document.addEventListener("keydown",i=>{switch(i.code){case"ArrowUp":e.p(64);break;case"ArrowDown":e.p(128);break;case"ArrowLeft":e.p(32);break;case"ArrowRight":e.p(16);break;case"KeyX":e.p(1);break;case"KeyZ":e.p(2);break;case"Enter":e.p(8);break;case"Backspace":e.p(4);break;case"KeyN":t=0==t?s.length-1:t-1,r();break;case"KeyM":t=t+1==s.length?0:t+1,r()}}),document.addEventListener("keyup",s=>{switch(s.code){case"ArrowUp":e.v(64);break;case"ArrowDown":e.v(128);break;case"ArrowLeft":e.v(32);break;case"ArrowRight":e.v(16);break;case"KeyX":e.v(1);break;case"KeyZ":e.v(2);break;case"Enter":e.v(8);break;case"Backspace":e.v(4)}}),window.requestAnimationFrame(U)}i(184),"complete"===document.readyState?u():window.onload=s=>u(),window.onresize=()=>o()},184:(s,t,i)=>{i.r(t)},364:function(s,t,i){var h=this&&this.o||function(s){return s&&s.i?s:{default:s}};Object.defineProperty(t,"i",{value:!0});const e=h(i(806));class a{static _=160;static R=144;A;state;j;U;S;framebuffer;constructor(s){this.A=s,this.state=0,this.j=0,this.U=[],this.framebuffer=new Uint8Array(a._*a.R),this.S=new Uint8Array(a._*a.R)}m(){return this.framebuffer}C(s,t){return(s[0]<<t&128)>>7|(s[1]<<t&128)>>6}O(s,t,i){return(i?s<<4:4096+(e.default.L(s)<<4))+(t<<1)}M(s,t,i,h){const e=this.A.read(32768+(s?7168:6144)+(h>>3<<5)+(i>>3)),a=this.O(e,7&h,t);return this.C([this.A.read(32768+a),this.A.read(32768+a+1)],7&i)}B(s,t){return t>>2*(s&=3)&3}D(s,t){const i=this.A.P(64),h=!!(8&i),e=!!(64&i);let r=!!(1&i),c=!!(32&i),b=!!(2&i);const n=!!(16&i),k=this.A.P(67),o=this.A.P(66),u=this.A.P(75),l=this.A.P(74),f=[this.A.P(72),this.A.P(73)];if(c=c&&u<167&&l<144&&l<=s,b=b&&this.U.length>0,!(c||r||b))return;const d=s+o&255,w=32768+(h?7168:6144)+(d>>3<<5),m=[0,0];for(let i=0;i<a._;i++){let h=0;if(c&&i+7>=u)h=this.M(e,n,i+7-u,s-l);else if(r){const s=i+k&255;if(!(i&&7&s)){const t=s>>3,i=this.A.read(w+t),h=this.O(i,7&d,n);m[0]=this.A.read(32768+h),m[1]=this.A.read(32768+h+1)}h=this.C(m,i+k&7)}let o=this.B(h,t);if(b){let s=!1;for(let t=0;t<this.U.length;t++){const e=this.U[t];if(i+8<e.x||i+8>=e.x+8)continue;const a=i+8-e.x,r=!!(32&e.H),c=this.C(e.I,r?7-a:a);if(0==c)continue;const b=!(128&e.H);if((s||h>0)&&!b)continue;const n=f[16&e.H?1:0];o=this.B(c,n),s=!0}}this.S[s*a._+i]=o}}K(s){const t=4&this.A.P(64)?16:8;this.U.length=0;for(let i=0;i<160;i+=4){const h=this.A.read(65024+i),e=this.A.read(65024+i+1);if(e>0&&h<160&&e<168&&s+16>=h&&s+16<h+t){let a=this.U.length;for(;a>0&&this.U[a-1].x>e;)a<10&&(this.U[a]=this.U[a-1]),--a;if(a<10){let r=this.A.read(65024+i+2);const c=this.A.read(65024+i+3);16==t&&(r&=254);let b=s+16-h;64&c&&(b=t-1-b);const n=this.O(r,b,!0),k={x:e,H:c,I:[this.A.read(32768+n),this.A.read(32768+n+1)]};a==this.U.length?this.U.push(k):this.U[a]=k}}}}l(s,t){const i=[255,170,133,0],h=this.A.P(71),e=this.A.P(64);let r=this.A.P(65);if(!(0+(128&e)))return this.state=0,this.j=0,r&=-4,this.A.T(65,r),void this.A.T(68,0);for(this.A.P(68)===this.A.P(69)?4&r||(r|=4,this.A.T(65,r),64&r&&this.A.T(15,2|this.A.P(15))):4&r&&(r&=-5,this.A.T(65,r)),this.j+=s;this.j>0;)switch(this.state){case 0:if(2!=(3&r)&&(r=-4&r|2,this.A.T(65,r),32&r&&this.A.T(15,2|this.A.P(15))),this.j>=20){const s=this.A.P(68);this.K(s),this.state=1;break}return;case 1:if(3&~r&&(r=-4&r|3,this.A.T(65,r)),this.j>=63){if(t){const s=this.A.P(68);this.D(s,h)}this.state=2;break}return;case 2:if(3&r&&(r&=-4,this.A.T(65,r),128&r&&this.A.T(15,2|this.A.P(15))),this.j>=114){this.j-=114;const s=this.A.P(68)+1;this.state=s<a.R?0:3,this.A.T(68,s);break}return;case 3:if(1!=(3&r)&&(r=-4&r|1,this.A.T(65,r),this.A.T(15,1|this.A.P(15)),t))for(let s=0;s<a.R;s++){let t=s*a._,h=s*a._;for(let s=0;s<a._;s++)this.framebuffer[h++]=i[3&this.S[t++]]}if(this.j>=114){this.j-=114;let s=this.A.P(68)+1;154===s&&(s=0,this.state=0),this.A.T(68,s);break}return}}}t.default=a},706:(s,t)=>{Object.defineProperty(t,"i",{value:!0}),t.default=class{F;N;W;X;Y;Z;constructor(s){switch(this.N=s,this.F=new Uint8Array(65536),this.Y=0,this.W=this.X=1,this.Z=0,s[327]){case 0:this.Z=0;break;case 1:case 2:case 3:this.Z=1;break;case 15:case 16:case 17:case 18:case 19:this.Z=3;break;default:console.log("Unhandled rom type",s[327])}for(let t=0;t<32768;t++)this.F[t]=s[t]}read(s){if(s>=16384&&s<32768)switch(this.Z){case 1:case 3:if(this.W)return this.N[(this.W<<14)+(16383&s)];break;case 2:if(this.X)return this.N[(this.X<<14)+(16383&s)]}return this.F[s]}write(s,t){if(t&=255,s>=65280&&65350==s){const s=t<<8;for(let t=0;t<160;t++)this.F[65024+t]=this.F[s+t];return}switch(this.Z){case 1:case 3:s<8192||(s<16384?(this.W=31&t,0!=t&&32!=t&&64!=t&&96!=t||++this.W):s<24576?0==this.Y?this.W|=(3&t)<<5:this.W=3&t:s<32768?this.Y=t>0?1:0:this.F[s]=t);break;case 2:s<8192||(s<16384?(this.X=31&t,0!=t&&32!=t&&64!=t&&96!=t||++this.X):s>=32768&&(this.F[s]=t));break;default:s>=32768&&(this.F[s]=t)}}P(s){return this.read(65280+s)}T(s,t){this.write(65280|s,t)}}},806:(s,t,i)=>{Object.defineProperty(t,"i",{value:!0}),t.u=t.G=void 0,i(364);class h{q;J;constructor(){this.q=0,this.J=0}V(s){return this.q=255&s,this}$(s){return this.J=255&s,this}ss(s){return this.J=255&s,this.q=s>>8&255,this}ts(){return this.q}hs(){return this.J}es(){return(this.q<<8)+this.J}}t.G=h,t.u=class{A;rs;cs;constructor(s){this.A=s,this.rs=0,this.cs=0}l(s){this.cs+=s,-64&this.cs&&(this.A.T(4,this.A.P(4)+(this.cs>>6)),this.cs&=63);const t=this.A.P(7);if(!(4&t))return;let i;switch(this.rs+=s,3&t){case 0:i=12;break;case 1:i=18;break;case 2:i=16;break;default:i=14}const h=20-i;if(this.rs>>h>0){const s=1<<h;do{this.A.T(5,this.A.P(5)+1),0==this.A.P(5)&&(this.A.T(15,4|this.A.P(15)),this.A.T(5,this.A.P(6))),this.rs-=s}while(this.rs>>h>0)}}};class e{static bs=[1,3,2,2,1,1,2,1,5,2,2,2,1,1,2,1,0,3,2,2,1,1,2,1,3,2,2,2,1,1,2,1,2,3,2,2,1,1,2,1,2,2,2,2,1,1,2,1,2,3,2,2,3,3,3,1,2,2,2,2,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,2,2,2,2,2,2,0,2,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,2,3,3,4,3,4,2,4,2,4,3,0,3,6,2,4,2,3,3,0,3,4,2,4,2,4,3,0,3,0,2,4,3,3,2,0,0,4,2,4,4,1,4,0,0,0,2,4,3,3,2,1,0,4,2,4,3,2,4,1,0,0,2,4];static ns=[2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,4,2];ks;us;ls;fs;ds;pc;A;ws;ps;vs;buttons;gs(){return this.pc}ys(){return this.ds}_s(){return this.ks}xs(){return this.us}Rs(){return this.ls}As(){return this.fs}constructor(s){this.A=s,this.ks=new h,this.us=new h,this.ls=new h,this.fs=new h,this.ks.ss(432),this.us.ss(19),this.ls.ss(216),this.fs.ss(333),this.pc=256,this.ds=65534,this.ws=0,this.ps=!1,this.vs=!1,this.buttons=0,s.T(0,207),s.T(2,126),s.T(5,0),s.T(6,0),s.T(7,0),s.write(65296,128),s.write(65297,191),s.write(65298,243),s.write(65300,191),s.write(65302,63),s.write(65303,0),s.write(65305,191),s.write(65306,127),s.write(65307,255),s.write(65308,159),s.write(65310,191),s.write(65312,255),s.write(65313,0),s.write(65314,0),s.write(65315,191),s.write(65316,119),s.write(65317,243),s.write(65318,241),s.T(64,145),s.T(65,0),s.T(66,0),s.T(67,0),s.T(68,0),s.T(69,0),s.T(71,252),s.T(72,255),s.T(73,255),s.T(74,0),s.T(75,0),s.T(80,1),s.write(65535,0)}static L(s){return(s&=255)>127?s-256:s}js=()=>this.A.read(this.pc++);Us=()=>(new h).$(this.js()).V(this.js());Ss=()=>this.Us().es();Cs=s=>this.ks.$(this.ks.hs()|s);Os=s=>this.ks.$(this.ks.hs()&~s);Ls=(s,t)=>t?this.Cs(s):this.Os(s);Ms=s=>0!=(this.ks.hs()&s);Bs(s){this.A.write(--this.ds,s.ts()),this.ds&=65535,this.A.write(--this.ds,s.hs()),this.ds&=65535}Ds(){const s=new h;return s.$(this.A.read(this.ds++)),this.ds&=65535,s.V(this.A.read(this.ds++)),this.ds&=65535,s}Ps=(s,t,i)=>{const h=s+t+(i?1:0),e=(15&s)+(15&t)+(i?1:0);return this.Ls(128,!(255&h)),this.Os(64),this.Ls(32,e>15),this.Ls(16,h>255),255&h};Es=(s,t)=>{const i=s+t,h=(4095&s)+(4095&t);return this.Os(64),this.Ls(32,h>4095),this.Ls(16,i>65535),65535&i};Hs=(s,t,i)=>{const h=s-t-(i?1:0)&65535,e=(15&s)-(15&t)-(i?1:0)&65535;return this.Ls(128,!(255&h)),this.Cs(64),this.Ls(32,e>15),this.Ls(16,h>255),255&h};Is(s){return this.Ls(128,255==s),this.Os(64),this.Ls(32,!(15&~s)),s+1}Ks(s){return this.Ls(128,1==s),this.Cs(64),this.Ls(32,!(15&s)),s-1}and(s){this.ks.V(this.ks.ts()&s),this.Ls(128,0==this.ks.ts()),this.Os(64),this.Cs(32),this.Os(16)}or(s){this.ks.V(this.ks.ts()|s),this.Ls(128,0==this.ks.ts()),this.Os(64),this.Os(32),this.Os(16)}xor(s){this.ks.V(this.ks.ts()^s),this.Ls(128,0==this.ks.ts()),this.Os(64),this.Os(32),this.Os(16)}Ts(s){return this.Ls(128,0==s),this.Os(64),this.Os(32),this.Ls(16,!!(128&s)),255&(s<<1|s>>7)}Fs(s){return this.Ls(128,0==s),this.Os(64),this.Os(32),this.Ls(16,!!(1&s)),255&(s>>1|s<<7)}Ns(s){const t=this.Ms(16)?1:0;return this.Ls(128,!((s<<1)+t&255)),this.Os(64),this.Os(32),this.Ls(16,!!(128&s)),(s<<1)+t&255}Ws(s){const t=this.Ms(16)?128:0;return this.Ls(128,(s>>1)+t==0),this.Os(64),this.Os(32),this.Ls(16,!!(1&s)),(s>>1)+t}zs(s){return this.Cs(64),this.Cs(32),255^s}Xs(s){return this.Ls(128,!(s<<1&255)),this.Os(64),this.Os(32),this.Ls(16,!!(128&s)),s<<1&255}Ys(s){return this.Ls(128,!(255&(s>>1|128&s))),this.Os(64),this.Os(32),this.Ls(16,!!(1&s)),255&(s>>1|128&s)}Zs(s){return this.Ls(128,!(s>>1&255)),this.Os(64),this.Os(32),this.Ls(16,!!(1&s)),s>>1&255}Gs(s){return s=255&(s>>4|s<<4),this.Ls(128,0==s),this.Os(64),this.Os(32),this.Os(16),s}qs=s=>this.pc=s;Js=s=>this.pc+=e.L(s);Qs(){this.pc=this.Ds().es()}Vs(s){this.Bs((new h).ss(this.pc)),this.pc=s}$s(s,t){return t?(this.qs(s),1):0}st(s,t){return t?(this.Js(s),1):0}tt(s,t){return t?(this.Vs(s),3):0}it(s){return s?(this.Qs(),3):0}ht(s){switch(s){case 0:return this.us.ts();case 1:return this.us.hs();case 2:return this.ls.ts();case 3:return this.ls.hs();case 4:return this.fs.ts();case 5:return this.fs.hs();case 6:return this.A.read(this.fs.es());case 7:return this.ks.ts()}return 255}et(s,t){switch(s){case 0:return void this.us.V(t);case 1:return void this.us.$(t);case 2:return void this.ls.V(t);case 3:return void this.ls.$(t);case 4:return void this.fs.V(t);case 5:return void this.fs.$(t);case 6:return void this.A.write(this.fs.es(),t);case 7:return void this.ks.V(t)}}rt(s){const t=s>>6,i=s>>3&7,h=7&s;let e=this.ht(h);switch(t){case 0:switch(i){case 0:e=this.Ts(e);break;case 1:e=this.Fs(e);break;case 2:e=this.Ns(e);break;case 3:e=this.Ws(e);break;case 4:e=this.Xs(e);break;case 5:e=this.Ys(e);break;case 6:e=this.Gs(e);break;case 7:e=this.Zs(e)}this.et(h,e);break;case 1:this.Ls(128,!(e&1<<i)),this.Os(64),this.Cs(32);break;case 2:e&=~(1<<i),this.et(h,e);break;case 3:e|=1<<i,this.et(h,e)}}p(s){this.buttons|=s}v(s){this.buttons&=~s}l(){let s=0;const t=255^this.buttons,i=this.A.P(0);32&i?this.A.T(0,240&i|t>>4&15):16&i?this.A.T(0,240&i|15&t):3==i&&this.A.T(0,255);const h=this.A.P(15),a=31&h&this.A.read(65535);if(0!=a&&(this.ps&&(this.ps=!1),1&this.ws))for(let t=0;t<5;t++)if(a&1<<t){this.ws&=-2,s+=2,this.Vs(64+(t<<3)),this.A.T(15,h&~(1<<t));break}if(this.ps)return++s,s;2&this.ws&&(this.ws|=1,this.ws&=-3),this.pc;const r=this.js();this.vs&&(this.vs=!1,--this.pc);const c=203==r?this.js():0,b=this.Ms(16);switch(r){case 0:case 16:break;case 1:this.us=this.Us();break;case 17:this.ls=this.Us();break;case 33:this.fs=this.Us();break;case 49:this.ds=this.Us().es();break;case 2:this.A.write(this.us.es(),this.ks.ts());break;case 18:this.A.write(this.ls.es(),this.ks.ts());break;case 34:this.A.write(this.fs.es(),this.ks.ts()),this.fs.ss(this.fs.es()+1);break;case 50:this.A.write(this.fs.es(),this.ks.ts()),this.fs.ss(this.fs.es()-1);break;case 3:this.us.ss(this.us.es()+1);break;case 19:this.ls.ss(this.ls.es()+1);break;case 35:this.fs.ss(this.fs.es()+1);break;case 51:++this.ds,this.ds&=65535;break;case 4:this.us.V(this.Is(this.us.ts()));break;case 20:this.ls.V(this.Is(this.ls.ts()));break;case 36:this.fs.V(this.Is(this.fs.ts()));break;case 52:{const s=this.Is(this.A.read(this.fs.es()));this.A.write(this.fs.es(),s);break}case 5:this.us.V(this.Ks(this.us.ts()));break;case 21:this.ls.V(this.Ks(this.ls.ts()));break;case 37:this.fs.V(this.Ks(this.fs.ts()));break;case 53:{const s=this.Ks(this.A.read(this.fs.es()));this.A.write(this.fs.es(),s);break}case 6:this.us.V(this.js());break;case 22:this.ls.V(this.js());break;case 38:this.fs.V(this.js());break;case 54:this.A.write(this.fs.es(),this.js());break;case 7:this.Os(128),this.Os(32),this.Os(64),this.Ls(16,!!(128&this.ks.ts())),this.ks.V(this.ks.ts()<<1|this.ks.ts()>>7);break;case 15:this.Os(128),this.Os(32),this.Os(64),this.Ls(16,!!(1&this.ks.ts())),this.ks.V(this.ks.ts()>>1|this.ks.ts()<<7);break;case 23:this.Os(128),this.Os(32),this.Os(64),this.Ls(16,!!(128&this.ks.ts())),this.ks.V(this.ks.ts()<<1|(b?1:0));break;case 31:this.Os(128),this.Os(32),this.Os(64),this.Ls(16,!!(1&this.ks.ts())),this.ks.V(this.ks.ts()>>1|(b?128:0));break;case 47:this.ks.V(this.zs(this.ks.ts()));break;case 39:{let s=this.ks.ts();this.Ms(64)?(this.Ms(32)&&(s-=6,s&=255),this.Ms(16)&&(s-=96)):(((15&s)>9||this.Ms(32))&&(s+=6),(s>159||this.Ms(16))&&(s+=96)),this.Ls(128,!(255&s)),this.Os(32),256&s&&this.Cs(16),this.ks.V(255&s);break}case 55:this.Os(64),this.Os(32),this.Cs(16);break;case 63:this.Os(64),this.Os(32),this.Ls(16,!this.Ms(16));break;case 8:{let s=this.Ss();this.A.write(s++,255&this.ds),this.A.write(s++,(65280&this.ds)>>8);break}case 232:{const s=this.ds+e.L(this.js())&65535;this.Os(128),this.Os(64),this.Ls(32,(15&s)<(15&this.ds)),this.Ls(16,(255&s)<(255&this.ds)),this.ds=s;break}case 248:{const s=this.ds+e.L(this.js())&65535;this.Os(128),this.Os(64),this.Ls(32,(15&s)<(15&this.ds)),this.Ls(16,(255&s)<(255&this.ds)),this.fs.ss(s);break}case 9:this.fs.ss(this.Es(this.fs.es(),this.us.es()));break;case 25:this.fs.ss(this.Es(this.fs.es(),this.ls.es()));break;case 41:this.fs.ss(this.Es(this.fs.es(),this.fs.es()));break;case 57:this.fs.ss(this.Es(this.fs.es(),this.ds));break;case 249:this.ds=this.fs.es();break;case 11:this.us.ss(this.us.es()-1);break;case 27:this.ls.ss(this.ls.es()-1);break;case 43:this.fs.ss(this.fs.es()-1);break;case 59:--this.ds,this.ds&=65535;break;case 10:this.ks.V(this.A.read(this.us.es()));break;case 26:this.ks.V(this.A.read(this.ls.es()));break;case 42:this.ks.V(this.A.read(this.fs.es())),this.fs.ss(this.fs.es()+1);break;case 58:this.ks.V(this.A.read(this.fs.es())),this.fs.ss(this.fs.es()-1);break;case 12:this.us.$(this.Is(this.us.hs()));break;case 28:this.ls.$(this.Is(this.ls.hs()));break;case 44:this.fs.$(this.Is(this.fs.hs()));break;case 60:this.ks.V(this.Is(this.ks.ts()));break;case 13:this.us.$(this.Ks(this.us.hs()));break;case 29:this.ls.$(this.Ks(this.ls.hs()));break;case 45:this.fs.$(this.Ks(this.fs.hs()));break;case 61:this.ks.V(this.Ks(this.ks.ts()));break;case 14:this.us.$(this.js());break;case 30:this.ls.$(this.js());break;case 46:this.fs.$(this.js());break;case 62:this.ks.V(this.js());break;case 64:this.us.V(this.us.ts());break;case 65:this.us.V(this.us.hs());break;case 66:this.us.V(this.ls.ts());break;case 67:this.us.V(this.ls.hs());break;case 68:this.us.V(this.fs.ts());break;case 69:this.us.V(this.fs.hs());break;case 70:this.us.V(this.A.read(this.fs.es()));break;case 71:this.us.V(this.ks.ts());break;case 72:this.us.$(this.us.ts());break;case 73:this.us.$(this.us.hs());break;case 74:this.us.$(this.ls.ts());break;case 75:this.us.$(this.ls.hs());break;case 76:this.us.$(this.fs.ts());break;case 77:this.us.$(this.fs.hs());break;case 78:this.us.$(this.A.read(this.fs.es()));break;case 79:this.us.$(this.ks.ts());break;case 80:this.ls.V(this.us.ts());break;case 81:this.ls.V(this.us.hs());break;case 82:this.ls.V(this.ls.ts());break;case 83:this.ls.V(this.ls.hs());break;case 84:this.ls.V(this.fs.ts());break;case 85:this.ls.V(this.fs.hs());break;case 86:this.ls.V(this.A.read(this.fs.es()));break;case 87:this.ls.V(this.ks.ts());break;case 88:this.ls.$(this.us.ts());break;case 89:this.ls.$(this.us.hs());break;case 90:this.ls.$(this.ls.ts());break;case 91:this.ls.$(this.ls.hs());break;case 92:this.ls.$(this.fs.ts());break;case 93:this.ls.$(this.fs.hs());break;case 94:this.ls.$(this.A.read(this.fs.es()));break;case 95:this.ls.$(this.ks.ts());break;case 96:this.fs.V(this.us.ts());break;case 97:this.fs.V(this.us.hs());break;case 98:this.fs.V(this.ls.ts());break;case 99:this.fs.V(this.ls.hs());break;case 100:this.fs.V(this.fs.ts());break;case 101:this.fs.V(this.fs.hs());break;case 102:this.fs.V(this.A.read(this.fs.es()));break;case 103:this.fs.V(this.ks.ts());break;case 104:this.fs.$(this.us.ts());break;case 105:this.fs.$(this.us.hs());break;case 106:this.fs.$(this.ls.ts());break;case 107:this.fs.$(this.ls.hs());break;case 108:this.fs.$(this.fs.ts());break;case 109:this.fs.$(this.fs.hs());break;case 110:this.fs.$(this.A.read(this.fs.es()));break;case 111:this.fs.$(this.ks.ts());break;case 112:this.A.write(this.fs.es(),this.us.ts());break;case 113:this.A.write(this.fs.es(),this.us.hs());break;case 114:this.A.write(this.fs.es(),this.ls.ts());break;case 115:this.A.write(this.fs.es(),this.ls.hs());break;case 116:this.A.write(this.fs.es(),this.fs.ts());break;case 117:this.A.write(this.fs.es(),this.fs.hs());break;case 118:this.ps=!0,this.vs=!(1&this.ws);break;case 119:this.A.write(this.fs.es(),this.ks.ts());break;case 120:this.ks.V(this.us.ts());break;case 121:this.ks.V(this.us.hs());break;case 122:this.ks.V(this.ls.ts());break;case 123:this.ks.V(this.ls.hs());break;case 124:this.ks.V(this.fs.ts());break;case 125:this.ks.V(this.fs.hs());break;case 126:this.ks.V(this.A.read(this.fs.es()));break;case 127:this.ks.V(this.ks.ts());break;case 128:this.ks.V(this.Ps(this.ks.ts(),this.us.ts(),!1));break;case 129:this.ks.V(this.Ps(this.ks.ts(),this.us.hs(),!1));break;case 130:this.ks.V(this.Ps(this.ks.ts(),this.ls.ts(),!1));break;case 131:this.ks.V(this.Ps(this.ks.ts(),this.ls.hs(),!1));break;case 132:this.ks.V(this.Ps(this.ks.ts(),this.fs.ts(),!1));break;case 133:this.ks.V(this.Ps(this.ks.ts(),this.fs.hs(),!1));break;case 134:this.ks.V(this.Ps(this.ks.ts(),this.A.read(this.fs.es()),!1));break;case 135:this.ks.V(this.Ps(this.ks.ts(),this.ks.ts(),!1));break;case 198:this.ks.V(this.Ps(this.ks.ts(),this.js(),!1));break;case 136:this.ks.V(this.Ps(this.ks.ts(),this.us.ts(),this.Ms(16)));break;case 137:this.ks.V(this.Ps(this.ks.ts(),this.us.hs(),this.Ms(16)));break;case 138:this.ks.V(this.Ps(this.ks.ts(),this.ls.ts(),this.Ms(16)));break;case 139:this.ks.V(this.Ps(this.ks.ts(),this.ls.hs(),this.Ms(16)));break;case 140:this.ks.V(this.Ps(this.ks.ts(),this.fs.ts(),this.Ms(16)));break;case 141:this.ks.V(this.Ps(this.ks.ts(),this.fs.hs(),this.Ms(16)));break;case 142:this.ks.V(this.Ps(this.ks.ts(),this.A.read(this.fs.es()),this.Ms(16)));break;case 143:this.ks.V(this.Ps(this.ks.ts(),this.ks.ts(),this.Ms(16)));break;case 206:this.ks.V(this.Ps(this.ks.ts(),this.js(),this.Ms(16)));break;case 144:this.ks.V(this.Hs(this.ks.ts(),this.us.ts(),!1));break;case 145:this.ks.V(this.Hs(this.ks.ts(),this.us.hs(),!1));break;case 146:this.ks.V(this.Hs(this.ks.ts(),this.ls.ts(),!1));break;case 147:this.ks.V(this.Hs(this.ks.ts(),this.ls.hs(),!1));break;case 148:this.ks.V(this.Hs(this.ks.ts(),this.fs.ts(),!1));break;case 149:this.ks.V(this.Hs(this.ks.ts(),this.fs.hs(),!1));break;case 150:this.ks.V(this.Hs(this.ks.ts(),this.A.read(this.fs.es()),!1));break;case 151:this.ks.V(this.Hs(this.ks.ts(),this.ks.ts(),!1));break;case 214:this.ks.V(this.Hs(this.ks.ts(),this.js(),!1));break;case 152:this.ks.V(this.Hs(this.ks.ts(),this.us.ts(),this.Ms(16)));break;case 153:this.ks.V(this.Hs(this.ks.ts(),this.us.hs(),this.Ms(16)));break;case 154:this.ks.V(this.Hs(this.ks.ts(),this.ls.ts(),this.Ms(16)));break;case 155:this.ks.V(this.Hs(this.ks.ts(),this.ls.hs(),this.Ms(16)));break;case 156:this.ks.V(this.Hs(this.ks.ts(),this.fs.ts(),this.Ms(16)));break;case 157:this.ks.V(this.Hs(this.ks.ts(),this.fs.hs(),this.Ms(16)));break;case 158:this.ks.V(this.Hs(this.ks.ts(),this.A.read(this.fs.es()),this.Ms(16)));break;case 159:this.ks.V(this.Hs(this.ks.ts(),this.ks.ts(),this.Ms(16)));break;case 222:this.ks.V(this.Hs(this.ks.ts(),this.js(),this.Ms(16)));break;case 160:this.and(this.us.ts());break;case 161:this.and(this.us.hs());break;case 162:this.and(this.ls.ts());break;case 163:this.and(this.ls.hs());break;case 164:this.and(this.fs.ts());break;case 165:this.and(this.fs.hs());break;case 166:this.and(this.A.read(this.fs.es()));break;case 167:this.and(this.ks.ts());break;case 230:this.and(this.js());break;case 168:this.xor(this.us.ts());break;case 169:this.xor(this.us.hs());break;case 170:this.xor(this.ls.ts());break;case 171:this.xor(this.ls.hs());break;case 172:this.xor(this.fs.ts());break;case 173:this.xor(this.fs.hs());break;case 174:this.xor(this.A.read(this.fs.es()));break;case 175:this.xor(this.ks.ts());break;case 238:this.xor(this.js());break;case 176:this.or(this.us.ts());break;case 177:this.or(this.us.hs());break;case 178:this.or(this.ls.ts());break;case 179:this.or(this.ls.hs());break;case 180:this.or(this.fs.ts());break;case 181:this.or(this.fs.hs());break;case 182:this.or(this.A.read(this.fs.es()));break;case 183:this.or(this.ks.ts());break;case 246:this.or(this.js());break;case 184:this.Hs(this.ks.ts(),this.us.ts(),!1);break;case 185:this.Hs(this.ks.ts(),this.us.hs(),!1);break;case 186:this.Hs(this.ks.ts(),this.ls.ts(),!1);break;case 187:this.Hs(this.ks.ts(),this.ls.hs(),!1);break;case 188:this.Hs(this.ks.ts(),this.fs.ts(),!1);break;case 189:this.Hs(this.ks.ts(),this.fs.hs(),!1);break;case 190:this.Hs(this.ks.ts(),this.A.read(this.fs.es()),!1);break;case 191:this.Hs(this.ks.ts(),this.ks.ts(),!1);break;case 254:this.Hs(this.ks.ts(),this.js(),!1);break;case 193:this.us=this.Ds();break;case 209:this.ls=this.Ds();break;case 225:this.fs=this.Ds();break;case 241:this.ks=this.Ds(),this.ks.$(240&this.ks.hs());break;case 197:this.Bs(this.us);break;case 213:this.Bs(this.ls);break;case 229:this.Bs(this.fs);break;case 245:this.Bs(this.ks);break;case 234:this.A.write(this.Ss(),this.ks.ts());break;case 250:this.ks.V(this.A.read(this.Ss()));break;case 233:this.pc=this.fs.es();break;case 195:{const s=this.Ss();this.qs(s);break}case 194:s+=this.$s(this.Ss(),!this.Ms(128));break;case 202:s+=this.$s(this.Ss(),this.Ms(128));break;case 210:s+=this.$s(this.Ss(),!this.Ms(16));break;case 218:s+=this.$s(this.Ss(),this.Ms(16));break;case 224:this.A.write(65280+this.js(),this.ks.ts());break;case 226:this.A.write(65280+this.us.hs(),this.ks.ts());break;case 240:this.ks.V(this.A.read(65280+this.js()));break;case 242:this.ks.V(this.A.read(65280+this.us.hs()));break;case 24:{const s=this.js();this.Js(s);break}case 32:case 32:s+=this.st(this.js(),!this.Ms(128));break;case 40:case 40:s+=this.st(this.js(),this.Ms(128));break;case 48:case 48:s+=this.st(this.js(),!this.Ms(16));break;case 56:case 56:s+=this.st(this.js(),this.Ms(16));break;case 196:s+=this.tt(this.Ss(),!this.Ms(128));break;case 204:s+=this.tt(this.Ss(),this.Ms(128));break;case 212:s+=this.tt(this.Ss(),!this.Ms(16));break;case 220:s+=this.tt(this.Ss(),this.Ms(16));break;case 205:this.Vs(this.Ss());break;case 201:this.Qs();break;case 192:s+=this.it(!this.Ms(128));break;case 200:s+=this.it(this.Ms(128));break;case 208:s+=this.it(!this.Ms(16));break;case 216:s+=this.it(this.Ms(16));break;case 199:this.Vs(0);break;case 207:this.Vs(8);break;case 215:this.Vs(16);break;case 223:this.Vs(24);break;case 231:this.Vs(32);break;case 239:this.Vs(40);break;case 247:this.Vs(48);break;case 255:this.Vs(56);break;case 217:this.Qs(),this.ws|=1;break;case 243:this.ws=0;break;case 251:this.ws|=2;break;case 203:this.rt(c);break;default:throw"Unhandled opcode "+r}return s+=203==r?e.ns[c]:e.bs[r],s}}t.default=e}},t={};function i(h){var e=t[h];if(void 0!==e)return e.exports;var a=t[h]={exports:{}};return s[h].call(a.exports,a,a.exports,i),a.exports}i.r=s=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"i",{value:!0})},i(171)})();